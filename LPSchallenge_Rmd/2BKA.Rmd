---
title: "BKA2"
author: "Claudia Ki"
date: "1/27/2022"
output: html_document
---
Green iguana analysis for BKA from secondary challenge (primary challenge issue with assay, cannot run statistical analysis)

```{r setup, include=FALSE}
gi <- read.csv("C:/Users/claud/OneDrive - USU/Desktop/ASU green iguana 2021/greeniguanaAnalysis/modData/BKA2LPSlong.csv")
View(gi)
library("rstatix")
library("tidyverse")
library("dplyr")
library("ggpubr")
library("betareg")
library("glmmTMB")
str(gi)
gi$time <- as.factor(gi$time)
gi$iguanaID <- as.factor(gi$iguanaID)
gi$lps <- as.factor(gi$lps)
gi$diet <- as.factor(gi$diet)
str(gi)
gi <- gi %>%
  mutate(data = bka/100) 
View(gi)
gi <- gi %>%
  mutate(beta = ((data*35)+0.5)/36)
View(gi)
range(gi$beta)
```
The data for BKA is a percentage, data is not-normal and cannot be tansformed to be normal. I will run a beta regression. Note that the data was changed into decimal form and beta does not allow for numbers 0 and 1, just everything in between so this formula was applied (y * (n-1) + 0.5) / n where n is the sample size.
```{r}
glmm <- glmmTMB(beta ~ lps* diet * time + (1|iguanaID), data = gi, (family = beta_family(link = "logit")))
summary(glmm)
dietmodel <- glmmTMB(beta ~ diet * time + (1|iguanaID), data = gi, (family = beta_family(link = "logit")))
summary(dietmodel)
lpsmodel <- glmmTMB(beta ~ lps * time + (1|iguanaID), data = gi, (family = beta_family(link = "logit")))
summary(lpsmodel)
jdietmodel <- glmmTMB(beta ~ diet + (1|iguanaID), data = gi, (family = beta_family(link = "logit")))
summary(jdietmodel)
jlpsmodel <- glmmTMB(beta ~ lps + (1|iguanaID), data = gi, (family = beta_family(link = "logit")))
summary(jlpsmodel)
timemodel <- jlpsmodel <- glmmTMB(beta ~ time + (1|iguanaID), data = gi, (family = beta_family(link = "logit")))
summary(timemodel)

gi2 <- gi %>%
  group_by(lps, diet) %>%
  filter(time == c("0525bka", "0528bka", "0530bka")) 
shortmod <- glmmTMB(beta ~ diet * lps * time + (1|iguanaID), data = gi2, (family = beta_family(link = "logit")))
summary(shortmod) 

gi %>%
  group_by(diet) %>%
  get_summary_stats(bka, type = "mean_se")
```
# Summary of regressions
1) Difference between diet (glucose lower BKA)
2) Ran a series of models (LPSxtimexdiet, LPSxtime, dietxtime, LPS, time) all insignificant results even when taking out the last three time points 
